import urllib
import urllib2
import json

url = "http://localhost:8080/predict"

data = "{\"service\":\"cdis\",\"parameters\":{\"mllib\":{\"gpu\":false},\"input\":{\"id\":\"Identifiant_Produit\",\"scale\":true,\"separator\":\";\",\"max_vals\":[15786884.0,3.1561267455108465,3.7019559927284719,3.9557697938289495,4.675995087251067,4.388270510477014,4.908119835774414,8.908055486157537,4.78492931323126,3.8801859617233278,6.68350566085428,6.985836980806198,4.429231419228017,3.356389742344618,5.816208694363013,5.017703736200929,3.4054759219288828,3.825426460476592,2.321743030101061,3.334427395835519,6.535533729940653,5.701826742850244,5.32438135985285,5.916121620684862,5.696910539641976,5.508239768445492,6.6468994449824099,6.029280269518495,4.4766286017838869,5.434272188693285,2.020590250613168,5.681657496839762,5.014058363158256,5.902427905239165,5.813744014012627,4.289196575060487,3.1675054244988134,4.210058167343959,6.184158055111766,3.2595365829765798,2.4238991699239706,3.48486284352839,3.9549197740852835,4.2974724024534229,6.577960232272744,5.392199935391545,4.707011095131747,2.3023715671151878,6.740390468388796,5.527945099398494,2.1136362699908206,3.9629828488687055,3.86522105243057,6.768369732424617,5.713472533971071,6.571622617542744,4.429836769588292,3.2391661442816259,4.578571901423857,4.695556836901233,6.178592221811414,6.934477211907506,2.7926301676779987,3.7475427575409414,3.0100832134485246,4.317506158724427,6.206932288128883,2.787827479187399,6.0796672583092,4.218327548209345,4.003707790747285,7.45994455832988,4.159305669367313,4.998137271031737,4.419906068476848,5.982491859700531,5.259729298762977,7.2839035033248369,5.19984378432855,5.2165774633176629,7.985167307779193,4.281295237131417,6.378213740885258,9.898305255919695,5.588645860552788,3.7177611384540798,4.851985089480877,4.934093518182635,5.8542360085994009,5.669526709243655,2.8856102586723866,4.731255295686424,3.4682689160108568,4.892440355150029,4.662701626773924,3.571496315940749,3.9719920575153084,10.843684170395136,5.919061850756407,5.919021257199347,4.796914770267904,3.311867469921708,4.093566474504769,1.6350721009075642,3.7052992610260846,5.042785597965121,6.845181922544725,1.6527681965380908,2.675900106318295,2.9991857864661144,2.923388447612524,4.268013040127698,8.205121766775847,3.8764090538024904,3.452771889977157,5.961306392215192,2.8613065811805429,5.93241710215807,7.403132630570326,5.635940701002255,7.191135656088591,4.304792299866676,8.27029723674059,6.001807060092688,7.843087745830417,2.8049276471138,5.7768433429300789,5.5144003611058,4.241693060845137,5.813708419911563,3.6906156186014416,7.33400340937078,4.888154029846191,3.135750487446785,5.220952075906098,5.123358782962896,2.81133499648422,6.979347235755995,3.5227644860278817,5.150713774404721,5.047959172632545,4.795062034158036,6.210983628872782,6.351882005808875,3.6884215362370016,4.292183855199255,5.125127077102661,5.007863549515605,3.0871532422024758,4.705214248970151,6.871150633320212,3.4369686311110856,3.894330220995471,3.1003229051129894,8.433590261265636,2.9859284264966847,4.632741990499198,2.7209022721654039,4.067873576190323,2.4642732609063389,4.829563358798623,5.153554316610098,1.8440349213778973,4.349724002182484,5.476620549336076,3.0798409152776005,8.06058645248413,3.3844277798198165,5.29541151894955,1.8864207994192839,4.155786225572228,4.261465705931187,4.092594027519226,3.3978674982499799,4.448241464793682,4.972421122249216,5.571376090403646,5.54601697716862,4.922833708813414,1.51401590090245,3.3619573432952167,5.661025698296726,3.0771292857825758,5.1910098168300469,3.817010915838182,7.653293184936047,5.611178565988666,3.3061256520013559,8.12656794115901,5.1513580156024549,3.058152028825134,3.8936600224114956,4.20716597745195,4.805231910664588,2.484424397815019,3.5178336498793216,7.65296140126884,12.395651131868363,1.3587433330249042,4.711963013513014,3.5321699269115927,7471600.0],\"min_vals\":[281.0,-6.860038028098643,-6.437061904929578,-5.379118064884096,-4.568182167764462,-4.353600376285613,-4.106309860944748,-3.6487272903323175,-4.818662672303617,-3.672293132171035,-2.524700954090804,-2.2753894701600076,-4.306113271508366,-6.689424647018313,-8.231638886034489,-5.502417851239443,-6.939638830721378,-5.4531446266919378,-9.840598981827498,-5.300211920286529,-4.770368500147015,-2.704823609441519,-7.400542713701725,-6.4517656825482849,-5.896043879445642,-4.842362102121115,-5.510476735420525,-4.10045887902379,-5.072683968581259,-4.291218531318009,-8.488077603280545,-6.452986441552639,-3.1141473529860379,-4.32035799510777,-3.4996207295916976,-4.172896457836032,-5.9088970935335969,-5.849655857309699,-3.3496007766152617,-9.22046656627208,-6.1813050728233069,-5.745797595009208,-4.431548651307821,-3.2396894805133344,-8.83295188494958,-3.810643376666121,-3.1482949341880159,-5.496997122652829,-3.249614861095324,-4.425932260230184,-8.374251568864566,-4.202283184975386,-5.66264359280467,-3.1579850371927025,-3.8379232743754985,-3.3549004532396795,-3.884451433084905,-5.96380946948193,-3.608611081028357,-4.978750484064221,-3.126549015985802,-6.553971692919731,-4.846881788689643,-4.80201356485486,-4.741146311396733,-3.8515099277719857,-2.6572588765993716,-6.250808727927506,-3.0515297204256059,-4.526225555688143,-3.810302808880806,-3.7634683006908746,-9.527297423919663,-5.155438868328929,-5.12312775675673,-1.9781551230698825,-8.046708033885807,-3.1856857212260367,-3.7992566470056774,-4.7144021252170209,-4.953942249296233,-6.813689975999296,-3.282147674821317,-2.866095509380102,-3.1134753704536708,-4.406882271170616,-7.561684192158282,-7.492555699311197,-3.9535080603091048,-5.839019412174821,-9.699470404535532,-5.228363004513085,-10.45426862500608,-3.561815425986424,-7.287490067072213,-7.445802898611873,-4.905076934141107,-1.3200675128027797,-3.2894661200698467,-5.240807866415707,-3.962743377313018,-6.757945283316076,-3.971371022518724,-8.139971469528973,-4.64261822681874,-4.401534022996202,-4.145878736395389,-6.38253363315016,-13.385593388229609,-6.395147928036749,-7.009403171017766,-4.520523191429675,-3.4720688108354809,-6.393268303014338,-5.653587290085852,-2.771322124172002,-5.919009921140969,-5.69294604472816,-2.895047721453011,-2.6230804292108589,-2.992005931213498,-5.25670928414911,-2.1912018680013718,-4.101768532767892,-2.0654652155935766,-9.731846708804369,-2.658185373991728,-4.5822861841879789,-7.599474872229621,-3.9233080008998515,-5.345831584651023,-3.6015298976562919,-4.097958251833916,-6.4134612418711189,-4.592273892369121,-2.8034903965890409,-8.238683383911848,-6.957383044064045,-6.44757728651166,-5.0268662223243159,-3.720620953012258,-3.7309242964256557,-3.7937384724864389,-2.189839431317523,-4.835783828049898,-5.357345015741885,-4.670226451009512,-3.553983755875379,-6.229132431559265,-7.789694351144135,-4.283429674804211,-4.572331985458732,-6.242438756860793,-6.081731169717386,-2.0964011538308116,-5.507910680724308,-6.293345439946279,-6.673784865997732,-7.475315394811332,-8.734852891415358,-5.0090684103779499,-3.8778589675202967,-6.751428332645446,-4.214424233883619,-2.904685005545616,-6.3345418577082459,-2.625562561501283,-5.597280703485012,-3.5874657426029445,-8.820809421129525,-6.294310120400041,-4.837687435559928,-15.628020665142686,-4.429886073805392,-5.91864506714046,-4.31586278649047,-5.88625112362206,-4.240937088616192,-5.886249660514295,-10.659377302974463,-7.924185140058398,-5.1087108803913,-4.573448576498777,-10.79865892790258,-4.963335902430117,-5.019480675924569,-3.9891629572957756,-5.485537571905297,-2.803043122868985,-4.37892444524914,-7.836456742952578,-4.80415271432139,-5.160957921296358,-4.625540902023204,-6.630159945460036,-5.080031992867589,-4.426482103765011,-2.1478247810155155,-7.7912945337593559,-3.7939599892124535,-5.23858717828989,-1.0]},\"output\":{\"best\":1}},\"data\":[\"/media/data/datasets/datascience/cdiscount/test_w2v.csv\"]}"

req = urllib2.Request(url, data)
response = urllib2.urlopen(req)
jout = json.load(response)
preds = jout['body']['predictions']
print "Id_Produit;Id_Categorie"
for p in preds:
    cl0 = p['classes']
    print p['uri'] + ';' + cl0['cat']
